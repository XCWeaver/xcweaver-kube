// Copyright 2023 Google LLC
//
// Licensed under the Apache License, Version 2.0 (the "License");
// you may not use this file except in compliance with the License.
// You may obtain a copy of the License at
//
//      http://www.apache.org/licenses/LICENSE-2.0
//
// Unless required by applicable law or agreed to in writing, software
// distributed under the License is distributed on an "AS IS" BASIS,
// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
// See the License for the specific language governing permissions and
// limitations under the License.

syntax = "proto3";

option go_package = "github.com/XCWeaver/xcweaver-kube/internal/impl";

package impl;

import "google/protobuf/duration.proto";

// BabysitterConfig contains configuration passed to a babysitter.
message BabysitterConfig {
  string namespace = 1;              // Kubernetes namespace
  string deployment_id = 2;          // globally unique deployment id
  map<string, int32> listeners = 3;  // a map from listener name to port
  map<string, AntipodeAgentOptions> antipodeAgents = 4;  // a map from Antipode agent name to AntipodeAgentOptions
  map<string, string> groups = 5;    // a map from component name to group name
  Telemetry telemetry = 6;           // options to control how the telemetry is being manipulated.
}

message AntipodeAgentOptions {
  // the type of the datastore e.g. "redis"
  string datastoreType = 1;
  // the datastore host
  string host = 2;
  // the datastore port
  string port = 3;
  // the datastore user
  string user = 4;
  // the datastore password
  string password = 5;
  // the datastore name
  string datastore = 6;
}

// Options to control how the telemetry is being manipulated.
message Telemetry {
  MetricOptions metrics = 1;
}

// Options to configure how the metrics are handled by the deployer.
message MetricOptions {
  // If true, the deployer also exports metrics created implicitly by the
  // framework; e.g., autogenerated metrics, http metrics.
  bool auto_generate_metrics = 1;

  // How often to export the metrics to Google Cloud.
  google.protobuf.Duration export_interval = 2;
}
